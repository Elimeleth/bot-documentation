# Plug-in OpenAi


<Note>
Antes de começar, você deve se certificar de que tem uma chave de API da [OpenAI] (https://platform.openai.com)
</Note>

## Instalação

Instale a biblioteca para usar o OpenAI:

```bash {{ title: 'npm' }}
    npm install @builderbot-plugins/openai-agents
```

```typescript
    import "dotenv/config"
    import { createBot, createProvider, createFlow, addKeyword, EVENTS } = from "@bot-whatsapp/bot";

    import BaileysProvider from "@bot-whatsapp/provider/baileys";
    import MockAdapter from "@bot-whatsapp/database/mock";

    /** ... outras importações de fluxos */

    import { EmployeesClass } from "@builderbot-plugins/openai-agents";

    /**
     * Configuração do PLugin
     */

    const emplyeeInstace = new EmployeesClass({
            apiKey: "YOUR_OPEN_API_KEY_HERE",
            model: "gpt-3.5-turbo-16k",
            temperature: 0
    })

    emplyeeInstace.employees([
        {
            name: "SALES_AGENT", // NOME DO SEU AGENTE
            description: // DESCRIÇÃO DE SEU AGENTE E O QUE ELE FARÁ
                "Eu sou Rob, o vendedor amigável encarregado de ajudá-lo caso pretenda comprar ou esteja interessado em algum produto. Minhas respostas são breves.",
            flow: YOUR_FLOW_HERE, // SUA IMPLEMENTAÇÃO DE FLUXO
        },
        {
            nome: "EXPERT_AGENT",
            description:
                "Olá, meu nome é Leifer. Sou a pessoa especializada encarregada de solucionar suas dúvidas sobre nosso curso de chatbot, que é desenvolvido com Node.js e JavaScript. Esse curso foi criado para facilitar a automação de vendas em sua empresa. Fornecerei respostas concisas e diretas para maximizar sua compreensão."
            flow: expertoFlow,
        }
    ])


    /**
     * PONTO DE ENTRADA! 
     * ISSO NÃO USA AI PARA GERENCIAR EVENTOS
     * FLUXO DE BOAS-VINDAS OU PRIMEIRO FLUXO
     */
    const welcomeFlow = addKeyword(EVENTS.WELCOME).addAction(async (ctx, ctxFn) => {
        const {state} = ctxFn
        const pluginAi = ctxFn.extensions.employeesAddon

        /** Essa função é a que faz o trabalho */
        /** Determinar o fluxo e recuperar um objeto de funcionário */
        const employeeDeterminated = await pluginAi.determine(ctx.body)

        if(!employeeDeterminated?.employee){
            return ctxFn.flowDynamic("Oops, desculpe, não entendi. Como posso ajudá-lo?")
        }
        state.update({answer:employeeDeterminated.answer})
        pluginAi.gotoFlow(employeeDeterminated.employee, ctxFn)
    })

    const expertFlow = addKeyword(EVENTS.ACTION)
        .addAction(async (_, {state, flowDynamic}) =>{
            const currentState = state.getMyState()
            return flowDynamic(currentState.answer) /** aqui vem a resposta do plug-in OpenAi */
        })


    // ----- INITIALIZE
    const main = async () => {
        const adapterDB = new MockAdapter();
        const adapterFlow = createFlow([
            welcomeFlow,
            expertFlow
            /** ... outros fluxos */
        ]);
        
        const adapterProvider = createProvider(BaileysProvider);

        const configBot = {
            flow adapterFlow,
            provedor: adapterProvider,
            database: adapterDB,
        }

        const configExtra = {
            extensions:{
            employeesAddon: emplyeeInstace
            }
        }

        await createBot(configBot,configExtra);
    };

    main();
```

__REFERENCES:__ [OpenAi-Agents](https://github.com/codigoencasa/bot-plugins/tree/feature/shopify/packages/openai-agents)